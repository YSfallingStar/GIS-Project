{"mappings":"AAEA,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,gBAAgB,CAAC,OAAO,EAAE,WAAY;IACxE,GAAG,CAAC,IAAI,CAAC,gBAAgB,EAAE,WAAY;QACrC,MAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,AAAC;QACnD,MAAM,IAAI,GAAG,GAAG,CAAC,OAAO,EAAE,AAAC;QAC3B,SAAS,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;QAC1B,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;QAC3B,MAAM,UAAU,GAAG,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,AAAC;QAC9C,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAC1B,GAAG,CAAC,WAAW,EAAE,CAAC,gBAAgB,CAAC,mCAAmC,CAAC,EACvE,SAAU,MAAM,EAAE;YAChB,IAAI,MAAM,CAAC,KAAK,GAAG,CAAC,EAAE;gBACpB,MAAM,OAAO,GACX,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,OAAO,IAAI,MAAM,CAAC,KAAK,CAAC,OAAO,AAAC;gBAC1D,UAAU,CAAC,WAAW,GAAG,OAAO,KAAK,EAAE,GAAG,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC;gBAE9D,MAAM,eAAe,GAAG,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,eAAe,AAAC;gBAChE,IAAI,eAAe,EAAE;oBACnB,UAAU,CAAC,SAAS,GAAG,eAAe,CAAC;oBACvC,UAAU,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC;iBACxD;gBAED,IAAI,MAAM,AAAC;gBACX,MAAM,SAAS,GAAG,MAAM,CAAC,KAAK,CAAC,SAAS,AAAC;gBACzC,IAAI,SAAS,EACX,iEAAiE;gBACjE,MAAM,GAAG,SAAS,CACf,KAAK,wBAAwB,CAAC,CAAC,CAAC,CAChC,KAAK,CAAC,GAAG,CAAC,CACV,GAAG,CAAC,MAAM,CAAC,CAAC;qBAEf,MAAM,GAAG;oBACP,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,MAAM,CAAC,KAAK;AAC7C,qBAAC;AACD,qBAAC;oBACD,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC,MAAM;AAC/C,qBAAC;AACD,qBAAC;iBACF,CAAC;gBAEJ,gDAAgD;gBAChD,wBAAwB,CAAC,SAAS,CAAC,YAAY,CAAC,KAAK,CACnD,UAAU,EACV,MAAM,CACP,CAAC;gBACF,UAAU,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;aACpC;SACF,CACF,CAAC;QACF,UAAU,CAAC,WAAW,GAAG,CAAC,CAAC;QAC3B,IAAI,SAAS,CAAC,UAAU,EACtB,uDAAuD;QACvD,SAAS,CAAC,UAAU,CAAC,SAAS,CAAC,QAAQ,EAAE,EAAE,SAAS,CAAC,CAAC;aACjD;YACL,MAAM,IAAI,GAAG,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,AAAC;YACvD,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC,SAAS,EAAE,CAAC;YAClC,IAAI,CAAC,KAAK,EAAE,CAAC;SACd;KACF,CAAC,CAAC;IACH,GAAG,CAAC,UAAU,EAAE,CAAC;CAClB,CAAC,CAAC","sources":["src/js/download.js"],"sourcesContent":["\r\n\r\ndocument.getElementById('export-png').addEventListener('click', function () {\r\n    map.once('rendercomplete', function () {\r\n      const mapCanvas = document.createElement('canvas');\r\n      const size = map.getSize();\r\n      mapCanvas.width = size[0];\r\n      mapCanvas.height = size[1];\r\n      const mapContext = mapCanvas.getContext('2d');\r\n      Array.prototype.forEach.call(\r\n        map.getViewport().querySelectorAll('.ol-layer canvas, canvas.ol-layer'),\r\n        function (canvas) {\r\n          if (canvas.width > 0) {\r\n            const opacity =\r\n              canvas.parentNode.style.opacity || canvas.style.opacity;\r\n            mapContext.globalAlpha = opacity === '' ? 1 : Number(opacity);\r\n  \r\n            const backgroundColor = canvas.parentNode.style.backgroundColor;\r\n            if (backgroundColor) {\r\n              mapContext.fillStyle = backgroundColor;\r\n              mapContext.fillRect(0, 0, canvas.width, canvas.height);\r\n            }\r\n  \r\n            let matrix;\r\n            const transform = canvas.style.transform;\r\n            if (transform) {\r\n              // Get the transform parameters from the style's transform matrix\r\n              matrix = transform\r\n                .match(/^matrix\\(([^\\(]*)\\)$/)[1]\r\n                .split(',')\r\n                .map(Number);\r\n            } else {\r\n              matrix = [\r\n                parseFloat(canvas.style.width) / canvas.width,\r\n                0,\r\n                0,\r\n                parseFloat(canvas.style.height) / canvas.height,\r\n                0,\r\n                0,\r\n              ];\r\n            }\r\n            // Apply the transform to the export map context\r\n            CanvasRenderingContext2D.prototype.setTransform.apply(\r\n              mapContext,\r\n              matrix\r\n            );\r\n            mapContext.drawImage(canvas, 0, 0);\r\n          }\r\n        }\r\n      );\r\n      mapContext.globalAlpha = 1;\r\n      if (navigator.msSaveBlob) {\r\n        // link download attribute does not work on MS browsers\r\n        navigator.msSaveBlob(mapCanvas.msToBlob(), 'map.png');\r\n      } else {\r\n        const link = document.getElementById('image-download');\r\n        link.href = mapCanvas.toDataURL();\r\n        link.click();\r\n      }\r\n    });\r\n    map.renderSync();\r\n  });"],"names":[],"version":3,"file":"index.96b8491d.js.map","sourceRoot":"/__parcel_source_root/"}